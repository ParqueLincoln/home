<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Reservar Evento Popol-Nah - Parque Lincoln</title>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
  <style>
    /* ==========================================================================
        Estilos Generales y Modo Claro (por defecto)
        ========================================================================== */
    body {
      background: linear-gradient(to bottom right, #e0f2f7, #f0fdf4); /* Fondo claro suave */
      color: #4a5568; /* text-gray-800 */
      font-family: 'Inter', sans-serif; /* Fuente moderna */
      transition: background-color 0.3s ease, color 0.3s ease; /* Transición suave para el tema */
    }

    /* Estilos para la barra de navegación */
    nav {
        background-color: #ffffff; /* bg-white */
        color: #047857; /* text-green-700 */
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1); /* Sombra sutil */
        transition: background-color 0.3s ease, color 0.3s ease, box-shadow 0.3s ease;
    }

    nav h1 {
        color: #047857; /* text-green-700 */
    }

    nav a {
        color: #047857; /* text-green-700 */
    }

    /* Estilos para el pie de página */
    footer {
        background-color: #ffffff; /* Fondo blanco por defecto */
        color: #065f46; /* text-green-900 */
        box-shadow: 0 -4px 6px rgba(0, 0, 0, 0.05); /* Sombra sutil hacia arriba */
        transition: background-color 0.3s ease, color 0.3s ease, box-shadow 0.3s ease;
    }

    /* Estilos para secciones con fondos específicos en modo claro */
    section.events-section,
    section.comments-section,
    section.history-section,
    section.gallery-section,
    section.location-section,
    section.reservation-section { /* Nueva clase para la sección de reserva */
        background-color: #ffffff; /* Fondo blanco para secciones */
        border-radius: 1rem; /* Bordes más redondeados */
        box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05); /* Sombra más pronunciada */
        transition: background-color 0.3s ease, color 0.3s ease, box-shadow 0.3s ease;
    }
    /* La sección de ubicación no tenía un fondo específico, ahora lo tendrá */
    section.location-section {
        background-color: #ffffff;
    }

    /* Estilos para títulos y párrafos */
    h2 {
        color: #065f46; /* text-green-700 */
    }

    h3 {
        color: #065f46; /* text-green-800 */
    }

    p {
        color: #4a5568; /* text-gray-700 */
    }

    a {
        color: #047857; /* text-green-700 */
    }

    /* Estilos para campos de formulario */
    input,
    textarea {
        border-color: #a7f3d0; /* border-green-300 */
        background-color: #ffffff;
        color: #4a5568;
        box-shadow: inset 0 1px 2px rgba(0,0,0,0.06); /* Sombra interna sutil */
        transition: background-color 0.3s ease, color 0.3s ease, border-color 0.3s ease, box-shadow 0.3s ease;
    }

    /* Estilos para elementos específicos */
    .comment-item {
        background-color: #f0fdf4; /* Fondo más claro para items de comentario */
        box-shadow: 0 1px 3px rgba(0,0,0,0.08); /* Sombra ligera */
        transition: background-color 0.3s ease, color 0.3s ease, box-shadow 0.3s ease;
    }

    .event-item-card { /* Clase para el card de evento específico */
        background-color: #d1fae5; /* bg-green-100 */
        box-shadow: 0 2px 4px rgba(0,0,0,0.1); /* Sombra ligera */
        transition: background-color 0.3s ease, color 0.3s ease, box-shadow 0.3s ease;
    }
    .event-item-card h3 {
        color: #064e3b; /* text-green-900 */
    }
    .event-item-card p {
        color: #4a5568; /* text-gray-700 */
    }
    .event-item-card p.text-sm {
        color: #6b7280; /* text-gray-500 */
    }

    /* ==========================================================================
        Estilos para el Modo Oscuro (se aplican cuando body tiene la clase 'modo-oscuro')
        ========================================================================== */
    body.modo-oscuro {
      background: #0d1117; /* Fondo muy oscuro, base */
      color: #c9d1d9; /* Texto gris claro para legibilidad */
    }

    body.modo-oscuro nav,
    body.modo-oscuro footer {
        background-color: #161b22; /* Un gris oscuro para nav y footer */
        color: #58a6ff; /* Azul vibrante para texto en nav/footer */
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3); /* Sombra más oscura */
    }

    body.modo-oscuro nav h1,
    body.modo-oscuro nav a,
    body.modo-oscuro nav span,
    body.modo-oscuro nav button {
        color: #58a6ff; /* Azul vibrante para enlaces y títulos en nav */
    }

    body.modo-oscuro section.events-section,
    body.modo-oscuro section.comments-section,
    body.modo-oscuro section.history-section,
    body.modo-oscuro section.gallery-section,
    body.modo-oscuro section.location-section,
    body.modo-oscuro section.reservation-section { /* Para la sección de reserva */
        background-color: #161b22; /* Fondo oscuro consistente para todas las secciones */
        color: #c9d1d9; /* Texto gris claro */
        box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.3), 0 4px 6px -2px rgba(0, 0, 0, 0.15); /* Sombra más oscura y pronunciada */
    }

    body.modo-oscuro h2,
    body.modo-oscuro h3 {
        color: #34d399; /* Verde esmeralda para títulos de sección */
    }

    body.modo-oscuro p,
    body.modo-oscuro a:not(.hover\:underline) {
        color: #8b949e; /* Gris medio para párrafos */
    }

    body.modo-oscuro input,
    body.modo-oscuro textarea {
        background-color: #0d1117; /* Fondo de input/textarea muy oscuro */
        border-color: #30363d; /* Borde más oscuro */
        color: #c9d1d9; /* Texto claro */
        box-shadow: inset 0 1px 2px rgba(0,0,0,0.3); /* Sombra interna más oscura */
    }

    body.modo-oscuro .comment-item {
        background-color: #21262d; /* Fondo de comentario más oscuro */
        color: #c9d1d9; /* Texto de comentario gris claro */
        box-shadow: 0 1px 3px rgba(0,0,0,0.2); /* Sombra más oscura */
    }

    body.modo-oscuro .event-item-card {
        background-color: #21262d; /* Fondo de tarjeta de evento más oscuro */
        color: #c9d1d9;
        box-shadow: 0 2px 4px rgba(0,0,0,0.2); /* Sombra más oscura */
    }
    body.modo-oscuro .event-item-card h3 {
        color: #34d399; /* Verde esmeralda para título de evento */
    }
    body.modo-oscuro .event-item-card p {
        color: #8b949e; /* Gris medio para texto de evento */
    }


    /* ==========================================================================
        Estilos de Componentes Específicos (Galería y Modal)
        ========================================================================== */
    /* Estilos para el contenedor de la imagen y el overlay de la galería */
    .image-container {
        position: relative;
        overflow: hidden;
        cursor: pointer;
        border-radius: 0.75rem;
    }

    .image-overlay {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(6, 95, 70, 0.6); /* Overlay original de la galería (verde semitransparente) */
        color: white;
        display: flex;
        justify-content: center;
        align-items: center;
        opacity: 0;
        transition: opacity 0.3s ease-in-out;
        border-radius: 0.75rem;
    }

    .image-container:hover .image-overlay {
        opacity: 1;
    }

    .image-container:hover img {
        transform: scale(1.05);
        transition: transform 0.3s ease-in-out;
    }

    /* ==========================================================================
        Estilos para el Modal de Éxito (Checkmark Animation)
        ========================================================================== */
    #successModal {
        background-color: rgba(0, 0, 0, 0.8); /* Fondo oscuro semitransparente */
        transition: opacity 0.3s ease-in-out;
    }

    #successModal > div { /* Contenido del modal */
        transform: scale(0.95);
        opacity: 0;
        transition: all 0.3s ease-in-out;
    }

    #successModal.opacity-100 > div {
        transform: scale(1);
        opacity: 1;
    }

    .checkmark {
        width: 100px;
        height: 100px;
        border-radius: 50%;
        display: block;
        stroke-width: 2;
        stroke: #4CAF50; /* Green color for success */
        stroke-miterlimit: 10;
        box-shadow: inset 0px 0px 0px #4CAF50;
        animation: fill .4s ease-in-out .4s forwards, scale .3s ease-in-out .9s both;
    }

    .checkmark__circle {
        stroke-dasharray: 166;
        stroke-dashoffset: 166;
        stroke-width: 2;
        stroke-miterlimit: 10;
        stroke: #4CAF50;
        fill: none;
        animation: stroke 0.6s cubic-bezier(0.65, 0, 0.45, 1) forwards;
    }

    .checkmark__check {
        transform-origin: 50% 50%;
        stroke-dasharray: 48;
        stroke-dashoffset: 48;
        animation: stroke 0.3s cubic-bezier(0.65, 0, 0.45, 1) 0.8s forwards;
    }

    @keyframes stroke {
        100% {
            stroke-dashoffset: 0;
        }
    }

    @keyframes fill {
        100% {
            box-shadow: inset 0px 0px 0px 30px #4CAF50;
        }
    }

    @keyframes scale {
        0%, 100% {
            transform: none;
        }
        50% {
            transform: scale3d(1.1, 1.1, 1);
        }
    }

    /* Dark mode adjustments for checkmark */
    body.modo-oscuro .checkmark {
        stroke: #34d399; /* Adjust green for dark mode */
        box-shadow: inset 0px 0px 0px #34d399;
    }
    body.modo-oscuro .checkmark__circle {
        stroke: #34d399;
    }
 </style>
</head>
<body class="font-sans" id="body">
    <!-- ==========================================================================
          Barra de Navegación Principal
          ========================================================================== -->
    <nav class="shadow-md px-6 py-4 flex justify-between items-center">
    <h1 class="text-2xl font-bold">Parque Lincoln</h1>
    <div id="navOpciones" class="space-x-4">
      <a href="index.html" class="hover:underline">Inicio</a>
      <a href="login.html" class="hover:underline">Login</a>
        <button id="darkModeToggle" class="bg-gray-200 text-gray-800 px-3 py-1 rounded-full hover:bg-gray-300 transition">Modo Oscuro</button>
    </div>
  </nav>

    <!-- ==========================================================================
          Banner Principal
          ========================================================================== -->
    <header class="w-full h-64 bg-cover bg-center relative" style="background-image: url('popol-nah.png')">
    <div class="absolute inset-0 bg-gradient-to-br from-black via-transparent to-green-900 opacity-60"></div>
    <div class="relative h-full flex items-center justify-center">
      <h1 class="text-white text-5xl font-extrabold drop-shadow-xl">Reservar Evento Popol-Nah</h1>
    </div>
  </header>

    <!-- ==========================================================================
          Sección: Formulario de Reserva Popol-Nah
          ========================================================================== -->
    <section class="p-6 mt-6 rounded-xl shadow-inner mx-4 my-8 reservation-section">
        <h2 class="text-3xl font-semibold mb-6 text-center">Formulario de Reserva para Popol-Nah"</h2>
        <form id="reservationForm" class="space-y-6 max-w-2xl mx-auto p-6 rounded-lg shadow-lg bg-gray-50 dark:bg-gray-800">
            <div class="flex flex-col">
                <label for="fechaInicio" class="text-lg font-medium mb-2 text-gray-700 dark:text-gray-300">Fecha y Hora de Inicio:</label>
                <input type="datetime-local" id="fechaInicio" name="fechaInicio" required class="w-full p-3 border rounded-xl focus:ring-blue-500 focus:border-blue-500">
                <p id="fechaInicioError" class="text-red-500 text-sm mt-1 hidden">La fecha de inicio no puede ser anterior a la fecha actual.</p>
            </div>
            <div class="flex flex-col">
                <label for="fechaFin" class="text-lg font-medium mb-2 text-gray-700 dark:text-gray-300">Fecha y Hora de Fin:</label>
                <input type="datetime-local" id="fechaFin" name="fechaFin" required class="w-full p-3 border rounded-xl focus:ring-blue-500 focus:border-blue-500">
                <p id="fechaFinError" class="text-red-500 text-sm mt-1 hidden">La fecha de fin no puede ser igual o anterior a la fecha de inicio.</p>
            </div>
            <div class="flex flex-col">
                <label for="correo" class="text-lg font-medium mb-2 text-gray-700 dark:text-gray-300">Tu Correo Electrónico:</label>
                <input type="email" id="correo" name="correo" placeholder="ejemplo@dominio.com" required class="w-full p-3 border rounded-xl focus:ring-blue-500 focus:border-blue-500">
            </div>
            <div class="flex flex-col">
                <label for="evento" class="text-lg font-medium mb-2 text-gray-700 dark:text-gray-300">Descripción del Evento:</label>
                <textarea id="evento" name="evento" placeholder="Describe brevemente lo que se realizará en el evento (mínimo 15 caracteres)" required minlength="15" rows="4" class="w-full p-3 border rounded-xl focus:ring-blue-500 focus:border-blue-500"></textarea>
            </div>
            <div class="text-center">
                <button type="submit" class="bg-blue-600 text-white px-8 py-3 rounded-lg hover:bg-blue-700 transition duration-300 ease-in-out shadow-lg transform hover:scale-105">
                    Enviar Reserva
                </button>
            </div>
        </form>
    </section>

    <!-- ==========================================================================
          Pie de Página
          ========================================================================== -->
    <footer class="text-center p-4 text-sm">
    © 2025 Parque Lincoln. Todos los derechos reservados. Creada por Carlos Marcenaro
  </footer>

    <!-- ==========================================================================
          Modal para la Visualización de Imágenes (Lightbox) - Mantenido por consistencia
          ========================================================================== -->
    <div id="imageModal" class="fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-[9999] opacity-0 pointer-events-none transition-opacity duration-300">
        <div class="relative bg-gray-900 p-4 rounded-lg shadow-2xl max-w-3xl max-h-[90vh] overflow-hidden flex flex-col">
            <button id="closeModal" class="absolute top-2 right-2 text-gray-300 hover:text-gray-100 text-3xl font-bold leading-none focus:outline-none">
                ×
            </button>
            <img id="modalImage" src="" alt="Imagen ampliada" class="max-w-full max-h-full object-contain rounded-lg">
        </div>
    </div>

    <!-- ==========================================================================
          Modal de Éxito de Reserva (Checkmark Animation)
          ========================================================================== -->
    <div id="successModal" class="fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-[10000] opacity-0 pointer-events-none transition-opacity duration-300">
        <div class="bg-white dark:bg-gray-800 p-8 rounded-lg shadow-2xl text-center max-w-md mx-4 transform scale-95 opacity-0 transition-all duration-300">
            <svg class="checkmark mx-auto mb-4" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 52 52">
                <circle class="checkmark__circle" cx="26" cy="26" r="25" fill="none"/>
                <path class="checkmark__check" fill="none" d="M14.1 27.2l7.1 7.2 16.7-16.8"/>
            </svg>
            <p class="text-2xl font-semibold mb-6 text-gray-800 dark:text-gray-200">¡Reserva Enviada con Éxito!</p>
            <div class="flex justify-center space-x-4">
                <button id="anotherReservationBtn" class="bg-green-600 text-white px-6 py-3 rounded-lg hover:bg-green-700 transition duration-300 ease-in-out shadow-lg">Hacer otra reserva</button>
                <button id="finishReservationBtn" class="bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition duration-300 ease-in-out shadow-lg">Finalizar</button>
            </div>
        </div>
    </div>

    <!-- ==========================================================================
          Scripts JavaScript
          ========================================================================== -->
  <script>
    // Lógica para detectar sesión y modificar interfaz (existente)
    const usuario = JSON.parse(localStorage.getItem("usuarioActual"));
    const navOpciones = document.getElementById("navOpciones");
    const body = document.getElementById("body");

    if (usuario) {
      navOpciones.innerHTML = `
        <span>Hola, ${usuario.user}</span>
        <a href="perfil.html" class="hover:underline">Perfil</a>
        <button onclick="cerrarSesion()" class="hover:underline">Cerrar sesión</button>
      `;

      if (usuario.role === "admin") {
        navOpciones.innerHTML += `<a href="admin.html" class="hover:underline">Panel Admin</a>`;
      }
    }

    function cerrarSesion() {
      localStorage.removeItem("usuarioActual");
      location.href = "index.html";
    }

    // Lógica para el botón de Modo Oscuro
    const darkModeToggle = document.getElementById('darkModeToggle');

    // Función para aplicar o remover el modo oscuro
    function applyDarkMode(isDarkMode) {
        if (isDarkMode) {
            body.classList.add('modo-oscuro');
            darkModeToggle.textContent = 'Modo Claro';
            darkModeToggle.classList.remove('bg-gray-200', 'text-gray-800', 'hover:bg-gray-300');
            darkModeToggle.classList.add('bg-gray-700', 'text-white', 'hover:bg-gray-600');
        } else {
            body.classList.remove('modo-oscuro');
            darkModeToggle.textContent = 'Modo Oscuro';
            darkModeToggle.classList.remove('bg-gray-700', 'text-white', 'hover:bg-gray-600');
            darkModeToggle.classList.add('bg-gray-200', 'text-gray-800', 'hover:bg-gray-300');
        }
    }

    // Verificar la preferencia de modo oscuro en el almacenamiento local al cargar la página
    const savedDarkMode = localStorage.getItem('darkMode') === 'true';
    applyDarkMode(savedDarkMode); // Aplica el modo oscuro guardado al cargar

    // Alternar modo oscuro al hacer clic en el botón
    darkModeToggle.addEventListener('click', () => {
        const currentMode = body.classList.contains('modo-oscuro');
        applyDarkMode(!currentMode);
        localStorage.setItem('darkMode', !currentMode);
    });

    // ==========================================================================
    // Lógica Específica del Formulario de Reserva (popol-nah.html)
    // ==========================================================================
    const fechaInicioInput = document.getElementById('fechaInicio');
    const fechaFinInput = document.getElementById('fechaFin');
    const fechaInicioError = document.getElementById('fechaInicioError');
    const fechaFinError = document.getElementById('fechaFinError');
    const reservationForm = document.getElementById('reservationForm');

    // Get references to new modal elements
    const successModal = document.getElementById('successModal');
    const successModalContent = successModal.querySelector('div'); // The inner div with content
    const anotherReservationBtn = document.getElementById('anotherReservationBtn');
    const finishReservationBtn = document.getElementById('finishReservationBtn');

    // Function to get current date and time in YYYY-MM-DDTHH:MM format
    function getCurrentDateTimeLocal() {
        const now = new Date();
        const year = now.getFullYear();
        const month = (now.getMonth() + 1).toString().padStart(2, '0');
        const day = now.getDate().toString().padStart(2, '0');
        const hours = now.getHours().toString().padStart(2, '0');
        const minutes = now.getMinutes().toString().padStart(2, '0');
        return `${year}-${month}-${day}T${hours}:${minutes}`;
    }

    // 1. Set current date and time as default and minimum for fechaInicio
    const currentDateTime = getCurrentDateTimeLocal();
    fechaInicioInput.value = currentDateTime;
    fechaInicioInput.min = currentDateTime;

    // Function to validate end date
    function validateFechaFin() {
        const inicio = new Date(fechaInicioInput.value);
        const fin = new Date(fechaFinInput.value);

        if (fin <= inicio) {
            fechaFinError.classList.remove('hidden');
            return false;
        } else {
            fechaFinError.classList.add('hidden');
            return true;
        }
    }

    // Event listener to update fechaFin minimum when fechaInicio changes
    fechaInicioInput.addEventListener('change', () => {
        fechaFinInput.min = fechaInicioInput.value; // End date cannot be earlier than start date
        validateFechaFin(); // Re-validate fechaFin if fechaInicio changes
    });

    // Event listener to validate fechaFin on change
    fechaFinInput.addEventListener('change', validateFechaFin);

    // Function to show the success modal
    function showSuccessModal() {
        successModal.classList.remove('opacity-0', 'pointer-events-none');
        successModal.classList.add('opacity-100', 'pointer-events-auto');
        successModalContent.classList.remove('scale-95', 'opacity-0');
        successModalContent.classList.add('scale-100', 'opacity-100');
    }

    // Function to hide the success modal
    function hideSuccessModal() {
        successModal.classList.remove('opacity-100', 'pointer-events-auto');
        successModal.classList.add('opacity-0', 'pointer-events-none');
        successModalContent.classList.remove('scale-100', 'opacity-100');
        successModalContent.classList.add('scale-95', 'opacity-0');
    }

    // Logic for reservation form submission
    if (reservationForm) {
        reservationForm.addEventListener('submit', function(event) {
            event.preventDefault(); // Prevent default form submission

            // Validate dates before sending
            const isFechaFinValid = validateFechaFin();
            const isFechaInicioValid = new Date(fechaInicioInput.value) >= new Date(currentDateTime); // Re-validate just in case

            if (!isFechaInicioValid) {
                fechaInicioError.classList.remove('hidden');
                return; // Stop submission if start date is invalid
            } else {
                fechaInicioError.classList.add('hidden');
            }

            if (!isFechaFinValid) {
                return; // Stop submission if end date is invalid
            }

            const fechaInicio = fechaInicioInput.value;
            const fechaFin = fechaFinInput.value;
            const correo = document.getElementById('correo').value;
            const evento = document.getElementById('evento').value; // Now gets the value from the textarea

            // Format data for email body
            const subject = encodeURIComponent(`Nueva Reserva de Evento Popol-Nah`);
            const body = encodeURIComponent(
                `Detalles de la Reserva:\n\n` +
                `Fecha y Hora de Inicio: ${fechaInicio}\n` +
                `Fecha y Hora de Fin: ${fechaFin}\n` +
                `Correo del Solicitante: ${correo}\n` +
                `Descripción del Evento: ${evento}\n\n` +
                `Por favor, confirme su reserva.`
            );

            // Create mailto link
            const mailtoLink = `mailto:lincolnparque825@gmail.com?subject=${subject}&body=${body}`;

            // Open mail client in a new window/tab to allow modal to be shown
            window.open(mailtoLink, '_blank');

            // Show success modal after attempting to open mail client
            showSuccessModal();
        });
    }

    // Event listeners for modal buttons
    anotherReservationBtn.addEventListener('click', () => {
        hideSuccessModal();
        reservationForm.reset(); // Reset the form fields
        // Re-set default date for new reservation
        const currentDateTime = getCurrentDateTimeLocal();
        fechaInicioInput.value = currentDateTime;
        fechaInicioInput.min = currentDateTime;
        fechaFinInput.value = ''; // Clear end date
        fechaInicioError.classList.add('hidden');
        fechaFinError.classList.add('hidden');
    });

    finishReservationBtn.addEventListener('click', () => {
        hideSuccessModal();
        window.location.href = 'index.html'; // Redirect to index.html
    });

    // The image modal is not strictly necessary on popol-nah.html,
    // but is kept for consistency if a gallery is added in the future.
    // Logic for image modal functionality (empty as there are no images on this page for the modal)
    const imageContainers = document.querySelectorAll('.image-container'); // Should not be any on this page
    const imageModal = document.getElementById('imageModal');
    const modalImage = document.getElementById('modalImage');
    const closeModalBtn = document.getElementById('closeModal');

    function openModal(imageSrc, imageAlt) { /* Not used on this page */ }
    function closeModal() { /* Not used on this page */ }

    if (imageContainers.length > 0) { // Only if there are image containers (to prevent errors if gallery is added)
        imageContainers.forEach(container => {
            container.addEventListener('click', () => {
                const img = container.querySelector('img');
                openModal(img.src, img.alt);
            });
        });
        closeModalBtn.addEventListener('click', closeModal);
        imageModal.addEventListener('click', (event) => {
            if (event.target === imageModal) {
                closeModal();
            }
        });
        document.addEventListener('keydown', (event) => {
            if (event.key === 'Escape' && imageModal.classList.contains('opacity-100')) {
                closeModal();
            }
        });
    }
  </script>
</body>
</html>
